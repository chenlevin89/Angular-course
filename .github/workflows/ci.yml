name: ci

on:
  push:
    branches-ignore:
        - "master"


jobs:
  ci-flow:
    runs-on: ubuntu-latest
    steps:
        - name: checkout
          uses: actions/checkout@v2
        - name: cache node_modules
          uses: actions/cache@v1
          with:
            path: ~/.npm
            key: ${{ runner.os }}-app-dependencies-${{ hashFiles('**/package-lock.json') }}
        - name: install dependencies
          run: npm ci
        - name: run linting
          run: npm run lint
        - name: run prettier
          run: npm run prettier:check
        - name: run unittest
          run: npm run test
        - name: build artifacts
          if: github.ref == 'refs/heads/master'
          run: |
            echo "Start building application"
            npm run build

